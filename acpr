import matplotlib.pyplot as plt
import seaborn as sns
import pandas as pd

# 1. R√©cup√©rer le meilleur mod√®le LGBM √† partir du RandomizedSearchCV
best_lgbm_model = random_search.best_estimator_.named_steps["clf"]

# 2. R√©cup√©rer les noms des variables utilis√©es
feature_names = X_train_final.columns if isinstance(X_train_final, pd.DataFrame) else best_row["features"]

# 3. Extraire les importances
importances = best_lgbm_model.feature_importances_
feat_imp = pd.Series(importances, index=feature_names)

# 4. Trier et afficher les plus importantes
top_features = feat_imp.sort_values(ascending=False).head(15)

# 5. Affichage graphique
plt.figure(figsize=(10, 6))
sns.barplot(x=top_features.values, y=top_features.index, palette="viridis")
plt.title("üìä Importance des variables ‚Äì LightGBM optimis√©")
plt.xlabel("Importance (feature_importances_)")
plt.ylabel("Variables")
plt.tight_layout()
plt.show()
