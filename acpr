from sklearn.ensemble import RandomForestClassifier
from sklearn.metrics import classification_report, confusion_matrix, roc_auc_score, f1_score
import numpy as np

for fold, (train_idx, test_idx) in enumerate(folds):
    print(f"\nüåÄ Fold {fold + 1}")

    # S√©parer les donn√©es
    X_train, X_test = X.iloc[train_idx], X.iloc[test_idx]
    y_train, y_test = y.iloc[train_idx], y.iloc[test_idx]

    # Entra√Ænement du mod√®le
    model = RandomForestClassifier(
        n_estimators=100,
        max_depth=None,
        class_weight='balanced',
        random_state=42,
        n_jobs=-1
    )
    model.fit(X_train, y_train)

    # Pr√©diction
    y_pred = model.predict(X_test)
    y_proba = model.predict_proba(X_test)[:, 1]  # pour AUC

    # √âvaluation
    print("Confusion matrix:")
    print(confusion_matrix(y_test, y_pred))

    print("\nClassification report:")
    print(classification_report(y_test, y_pred, digits=4))

    auc = roc_auc_score(y_test, y_proba)
    f1 = f1_score(y_test, y_pred)
    print(f"AUC: {auc:.4f} | F1-score: {f1:.4f}")
