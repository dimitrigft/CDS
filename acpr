import matplotlib.pyplot as plt
import seaborn as sns

# R√©cup√©ration du mod√®le Random Forest
rf_model = final_pipe.named_steps["clf"]

# R√©cup√©ration des noms de variables et de leur importance
feature_names = X.columns[best_row["features"]]
importances = rf_model.feature_importances_
feat_imp = pd.Series(importances, index=feature_names)

# Tri et s√©lection des 15 plus importantes
top_features = feat_imp.sort_values(ascending=False).head(15)

# Affichage du graphique
plt.figure(figsize=(10, 6))
sns.barplot(x=top_features.values, y=top_features.index, palette="crest")
plt.title("üå≥ Importance des variables - Random Forest")
plt.xlabel("Importance (feature_importances_)")
plt.ylabel("Variables")
plt.tight_layout()
plt.show()
