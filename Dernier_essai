%macro concat_filtre_tables;

    /* Flag pour identifier la premiÃ¨re table */
    %let first_table = 1;

    /* Boucle sur les annÃ©es */
    %do year = 2020 %to 2025;
        %do month = 1 %to 12;

            /* Stop aprÃ¨s juin 2025 */
            %if &year. = 2025 and &month. > 6 %then %goto done;

            /* Format du mois */
            %let mm = %sysfunc(putn(&month., z2.));
            /* Nom de bibliothÃ¨que (ex : DATE0620) */
            %let libname = DATE&mm.%substr(&year., 3, 2);

            /* VÃ©rifie si la table existe */
            %if %sysfunc(exist(&libname..SIN_DGL)) %then %do;

                %put ðŸ”Ž Lecture de &libname..SIN_DGL;

                /* PremiÃ¨re table : crÃ©ation */
                %if &first_table. = 1 %then %do;
                    data WORK.CONCAT_SIN_DGL_MA;
                        set &libname..SIN_DGL(where=(PRODUIT = "MA"));
                    run;
                    %let first_table = 0;
                %end;

                /* Append des suivantes */
                %else %do;
                    proc append base=WORK.CONCAT_SIN_DGL_MA
                                data=&libname..SIN_DGL(where=(PRODUIT = "MA"))
                                force;
                    run;
                %end;

            %end;

        %end;
    %end;

%done:
    %put âœ… Traitement terminÃ©. RÃ©sultat dans WORK.CONCAT_SIN_DGL_MA.;

%mend concat_filtre_tables;

%concat_filtre_tables;
